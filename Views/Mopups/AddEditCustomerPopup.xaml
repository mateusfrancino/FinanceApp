<?xml version="1.0" encoding="utf-8" ?>
<mopups:PopupPage
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:mopups="clr-namespace:Mopups.Pages;assembly=Mopups"  
    xmlns:toolkit="http://schemas.microsoft.com/dotnet/2022/maui/toolkit"
    x:Class="MeuClienteApp.Views.Mopups.AddEditCustomerPopup"
    BackgroundColor="#80000000"
    CloseWhenBackgroundIsClicked="False">

    <mopups:PopupPage.Resources>
        <ResourceDictionary>
            <Style x:Key="EntryValidStyle" TargetType="Entry">
                <Setter Property="TextColor" Value="#001861"/>
                <Setter Property="BackgroundColor" Value="White"/>
                <Setter Property="PlaceholderColor" Value="#6E77A0"/>
            </Style>

            <Style x:Key="EntryErrorStyle" TargetType="Entry">
                <Setter Property="TextColor" Value="#B00020"/>
                <Setter Property="BackgroundColor" Value="#FFF1F1"/>
                <Setter Property="PlaceholderColor" Value="#B00020"/>
            </Style>
        </ResourceDictionary>
    </mopups:PopupPage.Resources>


    <Grid HorizontalOptions="Center" VerticalOptions="Center" Padding="0">
        <Border Background="White" Stroke="#C7CBD0" StrokeThickness="1" Padding="0"
                WidthRequest="720" MaximumWidthRequest="720" MinimumWidthRequest="360">
            <Border.StrokeShape>
                <RoundRectangle CornerRadius="16"/>
            </Border.StrokeShape>

            <Grid RowSpacing="0">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <!-- Header -->
                <Image Grid.Row="0" Source="frame_superior_clientes.png" Aspect="Fill" HeightRequest="10"/>

                <!-- Conteúdo -->
                <Grid Grid.Row="1" Padding="16,12,16,8" RowSpacing="12">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <Grid Grid.Row="0" ColumnSpacing="12">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <Image Source="icone_cliente.png" WidthRequest="36" HeightRequest="36"
                               VerticalOptions="Center"/>
                        <Label Grid.Column="1" Text="{Binding Title}" FontFamily="OpenSansSemibold"
                               FontSize="18" TextColor="#001861" VerticalTextAlignment="Center"/>
                    </Grid>

                    <!-- Campos -->
                    <Grid Grid.Row="1" ColumnSpacing="14" RowSpacing="10">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="140"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <!-- Nome -->
                        <Label Grid.Row="0" Grid.Column="0" 
                               Text="Nome"
                               FontFamily="OpenSansSemibold" 
                               FontSize="12" 
                               TextColor="#6E77A0"/>
                        <Entry Grid.Row="0" Grid.Column="1"
                               Text="{Binding Name}"
                               FontFamily="OpenSansRegular" FontSize="14" TextColor="#001861"
                               Placeholder="Digite o nome" ReturnType="Next">
                            <Entry.Behaviors>
                                <toolkit:TextValidationBehavior
                                    RegexPattern="^[A-Za-zÀ-ÿ\s]+$"
                                    RegexOptions="IgnoreCase"
                                    Flags="ValidateOnValueChanged"
                                    InvalidStyle="{StaticResource EntryErrorStyle}"
                                    ValidStyle="{StaticResource EntryValidStyle}" />
                            </Entry.Behaviors>
                        </Entry>

                        <!-- Sobrenome -->
                        <Label Grid.Row="1" Grid.Column="0" 
                               Text="Sobrenome"
                               FontFamily="OpenSansSemibold" 
                               FontSize="12" 
                               TextColor="#6E77A0"/>
                        <Entry Grid.Row="1" Grid.Column="1"
                               Text="{Binding Lastname}"
                               FontFamily="OpenSansRegular" FontSize="14" TextColor="#001861"
                               Placeholder="Digite o sobrenome" ReturnType="Next">
                            <Entry.Behaviors>
                                <toolkit:TextValidationBehavior
                                    RegexPattern="^[A-Za-zÀ-ÿ\s]+$"
                                    RegexOptions="IgnoreCase"
                                    Flags="ValidateOnValueChanged"
                                    InvalidStyle="{StaticResource EntryErrorStyle}"
                                    ValidStyle="{StaticResource EntryValidStyle}" />
                            </Entry.Behaviors>
                        </Entry>

                        <!-- Idade -->
                        <Label Grid.Row="2" Grid.Column="0" 
                               Text="Idade"
                               FontFamily="OpenSansSemibold" 
                               FontSize="12" 
                               TextColor="#6E77A0"/>
                        <Entry Grid.Row="2" Grid.Column="1"
                               Text="{Binding AgeText}"
                               Keyboard="Numeric" MaxLength="3"
                               FontFamily="OpenSansRegular" FontSize="14" TextColor="#001861"
                               Placeholder="0" ReturnType="Next">
                            <Entry.Behaviors>
                                <toolkit:TextValidationBehavior
                                    RegexPattern="^\d+$"
                                    Flags="ValidateOnValueChanged"
                                    InvalidStyle="{StaticResource EntryErrorStyle}"
                                    ValidStyle="{StaticResource EntryValidStyle}" />
                            </Entry.Behaviors>
                        </Entry>

                        <!-- Endereço -->
                        <Label Grid.Row="3" Grid.Column="0" 
                               Text="Endereço"
                               FontFamily="OpenSansSemibold" 
                               FontSize="12" 
                               TextColor="#6E77A0"/>
                        <Entry Grid.Row="3" Grid.Column="1"
                               Text="{Binding Address}"
                               FontFamily="OpenSansRegular" FontSize="14" TextColor="#001861"
                               Placeholder="Rua, nº, Bairro, Cidade/UF" ReturnType="Done"/>

                    </Grid>

                    <!-- Separador -->
                    <Image Grid.Row="2" Source="frame_central_detalhes_cliente.png" Aspect="Fill" Margin="0,8" HeightRequest="3"/>

                    <!-- Botões -->
                    <Grid Grid.Row="3" ColumnDefinitions="*,*" ColumnSpacing="12" Margin="0,4,0,0">
                        <Button Text="Cancelar" FontFamily="OpenSansSemibold" Command="{Binding CancelCommand}"
                                BackgroundColor="#F5F5F5" TextColor="#001861" CornerRadius="10" HeightRequest="44"/>
                        <Button Grid.Column="1" Text="Salvar" FontFamily="OpenSansSemibold" Command="{Binding SaveCommand}"
                                BackgroundColor="#1857ae" TextColor="White" CornerRadius="10" HeightRequest="44"/>
                    </Grid>
                </Grid>

                <!-- Footer -->
                <Image Grid.Row="2" Source="frame_inferior_clientes.png" Aspect="Fill" HeightRequest="10"/>
            </Grid>
        </Border>
    </Grid>
</mopups:PopupPage>
